### Create a NodePort Service using specification file

`kubectl apply -f ./thingsboard-service.yaml`{{execute}}

### See the service

`kubectl get services --namespace dev-1`{{execute}}

### Let's see the logs to confirm the app is ready to handle requests

`kubectl logs -l app=thingsboard --namespace dev-1`{{execute}}

## Access the Webapp from external network

### Get the service port

`kubectl get services --namespace dev-1`{{execute}}

Take note of the generated port shown as 80:**port**/TCP

```bash
NAME                  TYPE       CLUSTER-IP      EXTERNAL-IP   PORT(S)
thingsboard-service   NodePort   10.96.170.117   <none>        80:32464/TCP
```

### Open the web interface

Click on `Select Port to view on Host 1` using the (+) menu item next to the Terminal tab
Enter the port generated by the NodePort service.

You may see the generated port by running:

`kubectl get service thingsboard-service --namespace dev-1`{{execute}}

Take note of the generated port shown as 80:**port**/TCP

```bash
NAME                  TYPE       CLUSTER-IP      PORT(S)
thingsboard-service   NodePort   10.96.170.117   80:32464/TCP
```

**To login:**
System Administrator: sysadmin@thingsboard.org / sysadmin
Tenant Administrator: tenant@thingsboard.org / tenant
Customer User: customer@thingsboard.org / customer

### Scale Down Deployment Replicas Set

We will now scale down the deployment to a single replica set

#### Edit the manifest

Edit the deployment manifest:

`vim ./thingsboard-deployment.yaml`{{execute}}

Change the replicas value from `3` to `1`. Simply place the cursor after `3`, press the `i` key, change it to `1` then hit the `escape` key.

To save and exit vim, type `:wq!` then `Enter`

#### Apply the deployment

Run this command to re apply the deployment manifest

`kubectl apply -f ./thingsboard-deployment.yaml`{{execute}}

#### See deployment

`kubectl get deployments --namespace dev-1`{{execute}}

You may also run this command to see that only one pod is running:

`kubectl get pods --namespace dev-1`{{execute}}
